# File Upload vulnerabiltiy

If the website allows us to upload any type files in user input, we can also check for this vulnerability. There may be client-side and server-side validation is done. If any of them does not do its job properly, we can able to take even a reverse shell.

## How to do that?

- Check by uploading any reverse shell php file (reverse_shell.php)
- if it checks for file extensions within client-side, use **double extension** method
  - change the file name by adding the allowed extension. For eg: if the website allows only .jpg file, rename it to **shell.php.jpg** and upload it
  - capture the packet using burpsuite, and change the file name from **shell.php.jpg** to **shell.php**, then forward it
  - if the server side validation is not done, may be we get a reverse shell
- if basic server-side validation is being done, we can also send the malicious php file with some modification
  - if we use **hexedit** tool, we can able to see the binary format of the file
  - the first 4 pairs [8 digits] or someting is called the **magic numbers** or **file signature**, to represent what type file is this
  - we can use some tools like **hexedit, xxd, bvi**
  - it only works when the server only checks the file signature and not the contents
